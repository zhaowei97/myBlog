# createRef的实现

> 该实现比较简单，直接看改造部分代码比较直白

```
这里的key主要用于后续DOM DIFF

// react.js
function createElement(type, config, children) {
++  let ref;
++  let key;
  if (config) {
++    ref = config.ref; // 通过它可以获取真实DOM元素
++    key = config.key; // 用于DOM DIFF移动元素处理
    delete config.__self;
    delete config.__source;
++    delete config.ref;
++    delete config.key;
  }
  let props = {
    ...config,
  };
  if (arguments.length > 3) {
    props.children = Array.prototype.slice.call(arguments, 2).map(toVdom);
  } else if (arguments.length === 3) {
    props.children = toVdom(children);
  }
  return {
    $$typeof: REACT_ELEMENT,
    type,
    props,
++    key,
++    ref,
  };
}

++ function createRef(params) {
++  return {
++    current: null,
++  };
++ }
```


```
这里就是将current关联上真实dom或者类组件实例
// react-dom.js

function createDOM(vdom) {

  ...

  vdom.dom = dom;
++  if (ref) {
++    ref.current = dom;
++  }
  return dom;
}


function mountClassComponent(vdom) {
  const { type, props, ref } = vdom;
  const classInstance = new type(props);
  if (ref) ref.current = classInstance;
  
  ...

  
  return createDOM(renderVdom);
}

```



